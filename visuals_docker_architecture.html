<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Docker Architecture ‚Äì UK News Scraper</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #0b0e17;
      color: #e0e6f0;
      padding: 30px 20px 40px;
      min-height: 100vh;
    }
    h1 {
      text-align: center;
      font-size: 1.6rem;
      color: #ffffff;
      margin-bottom: 4px;
    }
    .subtitle {
      text-align: center;
      font-size: 0.82rem;
      color: #5a6a85;
      margin-bottom: 36px;
    }

    /* ‚îÄ‚îÄ HOST MACHINE WRAPPER ‚îÄ‚îÄ */
    .host {
      max-width: 1100px;
      margin: 0 auto;
      border: 2px dashed #2a3a55;
      border-radius: 16px;
      padding: 24px;
      position: relative;
    }
    .host-label {
      position: absolute;
      top: -13px;
      left: 24px;
      background: #0b0e17;
      padding: 0 10px;
      font-size: 0.72rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: #2a3a55;
    }

    /* ‚îÄ‚îÄ DOCKER NETWORK BOX ‚îÄ‚îÄ */
    .docker-network {
      border: 2px solid #1e4a8a;
      border-radius: 14px;
      padding: 20px;
      margin-bottom: 20px;
      background: #0d1320;
      position: relative;
    }
    .network-label {
      position: absolute;
      top: -12px;
      left: 20px;
      background: #0d1320;
      padding: 0 10px;
      font-size: 0.72rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #3d8ef8;
    }

    /* ‚îÄ‚îÄ CONTAINER ROW ‚îÄ‚îÄ */
    .container-row {
      display: flex;
      gap: 20px;
      align-items: stretch;
      flex-wrap: wrap;
    }

    /* ‚îÄ‚îÄ INDIVIDUAL CONTAINER ‚îÄ‚îÄ */
    .container {
      flex: 1;
      min-width: 240px;
      border-radius: 12px;
      padding: 18px;
      position: relative;
    }
    .container.n8n {
      background: #0d2240;
      border: 2px solid #1e6fd6;
    }
    .container.scraper {
      background: #0d2a14;
      border: 2px solid #1e8a3c;
    }

    .container-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 14px;
    }
    .container-icon {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }
    .n8n .container-icon   { background: #1e4a8a; }
    .scraper .container-icon { background: #1e5a28; }

    .container-name {
      font-size: 1rem;
      font-weight: 700;
      color: #ffffff;
    }
    .container-image {
      font-size: 0.72rem;
      color: #5a7a9a;
      font-family: 'Courier New', monospace;
    }

    /* ‚îÄ‚îÄ PORT BADGES ‚îÄ‚îÄ */
    .port-row {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }
    .port {
      border-radius: 5px;
      padding: 3px 10px;
      font-size: 0.72rem;
      font-weight: 700;
      font-family: 'Courier New', monospace;
    }
    .port.host-port { background: #1a3a6a; color: #7ecfff; }
    .port.container-port { background: #1a4a2a; color: #7ef7a0; }
    .port-arrow { color: #5a6a85; font-size: 0.8rem; align-self: center; }

    /* ‚îÄ‚îÄ INFO LIST ‚îÄ‚îÄ */
    .info-list { list-style: none; }
    .info-list li {
      font-size: 0.8rem;
      color: #8a9ab5;
      padding: 4px 0;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      display: flex;
      gap: 6px;
      align-items: flex-start;
    }
    .info-list li:last-child { border-bottom: none; }
    .info-key {
      color: #5a8ab5;
      font-family: 'Courier New', monospace;
      font-size: 0.75rem;
      min-width: 80px;
      padding-top: 1px;
    }
    .info-val { color: #a0b4cc; }

    /* ‚îÄ‚îÄ NETWORK ARROW ‚îÄ‚îÄ */
    .network-arrow {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 0 10px;
      min-width: 80px;
    }
    .arrow-line {
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, #1e6fd6, #1e8a3c);
      position: relative;
    }
    .arrow-label {
      font-size: 0.68rem;
      color: #3d8ef8;
      text-align: center;
      margin-top: 5px;
      font-family: 'Courier New', monospace;
    }
    .arrow-method {
      font-size: 0.65rem;
      color: #5a6a85;
      text-align: center;
    }
    .arrow-chevron {
      color: #1e8a3c;
      font-size: 1rem;
      margin-top: 3px;
    }

    /* ‚îÄ‚îÄ VOLUMES SECTION ‚îÄ‚îÄ */
    .volumes-section {
      margin-top: 18px;
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }
    .volume {
      flex: 1;
      min-width: 200px;
      background: #161a28;
      border: 1px dashed #2a3a55;
      border-radius: 8px;
      padding: 12px 16px;
    }
    .volume-title {
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      color: #4a5a75;
      margin-bottom: 8px;
    }
    .volume-path {
      font-family: 'Courier New', monospace;
      font-size: 0.75rem;
      color: #7a8a9a;
      line-height: 1.6;
    }
    .volume-path span {
      color: #3d8ef8;
    }

    /* ‚îÄ‚îÄ HOST SERVICES ‚îÄ‚îÄ */
    .host-services {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    .host-service {
      flex: 1;
      min-width: 180px;
      background: #141820;
      border: 1px solid #222c3c;
      border-radius: 8px;
      padding: 12px 16px;
      text-align: center;
    }
    .host-service .svc-name {
      font-size: 0.85rem;
      font-weight: 700;
      color: #c0cce0;
      margin-bottom: 4px;
    }
    .host-service .svc-port {
      font-family: 'Courier New', monospace;
      font-size: 0.72rem;
      color: #5a8ab5;
    }
    .host-service .svc-desc {
      font-size: 0.7rem;
      color: #4a5a75;
      margin-top: 4px;
    }

    /* ‚îÄ‚îÄ DATA FLOW SECTION ‚îÄ‚îÄ */
    .dataflow {
      max-width: 1100px;
      margin: 24px auto 0;
      background: #0d1320;
      border: 1px solid #1e2a3a;
      border-radius: 14px;
      padding: 20px 24px;
    }
    .dataflow-title {
      font-size: 0.72rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #3a4a65;
      margin-bottom: 16px;
    }
    .flow-steps {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 0;
    }
    .step {
      background: #141e30;
      border: 1px solid #1e2a40;
      border-radius: 8px;
      padding: 10px 14px;
      text-align: center;
      min-width: 120px;
    }
    .step-num {
      font-size: 0.65rem;
      color: #3d8ef8;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .step-text {
      font-size: 0.8rem;
      color: #c0d0e8;
      margin-top: 3px;
      font-weight: 600;
    }
    .step-detail {
      font-size: 0.68rem;
      color: #4a5a75;
      margin-top: 2px;
      font-family: 'Courier New', monospace;
    }
    .step-arrow {
      color: #3d8ef8;
      font-size: 1.1rem;
      padding: 0 5px;
      flex-shrink: 0;
    }

    /* ‚îÄ‚îÄ HEALTHCHECK BADGE ‚îÄ‚îÄ */
    .health-badge {
      display: inline-block;
      background: #0d2a14;
      border: 1px solid #1e5a28;
      border-radius: 20px;
      padding: 2px 10px;
      font-size: 0.68rem;
      color: #4ef07a;
      font-family: 'Courier New', monospace;
      margin-top: 8px;
    }

    /* ‚îÄ‚îÄ DEPENDS ON ‚îÄ‚îÄ */
    .depends-note {
      font-size: 0.7rem;
      color: #4a5a75;
      font-style: italic;
      margin-top: 6px;
    }

    footer {
      text-align: center;
      margin-top: 30px;
      font-size: 0.7rem;
      color: #2a3a4a;
    }
  </style>
</head>
<body>

  <h1>Docker Architecture</h1>
  <p class="subtitle">UK News Scraper + N8N ¬∑ docker-compose.yml ¬∑ Internal Reference</p>

  <!-- HOST MACHINE -->
  <div class="host">
    <div class="host-label">üñ•Ô∏è Host Machine ‚Äî Ubuntu Linux (sufideen)</div>

    <!-- DOCKER NETWORK -->
    <div class="docker-network">
      <div class="network-label">üê≥ Docker Network (bridge ‚Äî default)</div>

      <div class="container-row">

        <!-- N8N CONTAINER -->
        <div class="container n8n">
          <div class="container-header">
            <div class="container-icon">‚öôÔ∏è</div>
            <div>
              <div class="container-name">n8n</div>
              <div class="container-image">docker.n8n.io/n8nio/n8n</div>
            </div>
          </div>

          <div class="port-row">
            <span class="port host-port">host:5678</span>
            <span class="port-arrow">‚Üî</span>
            <span class="port container-port">container:5678</span>
          </div>

          <ul class="info-list">
            <li><span class="info-key">restart</span><span class="info-val">unless-stopped</span></li>
            <li><span class="info-key">timezone</span><span class="info-val">Europe/London</span></li>
            <li><span class="info-key">volume</span><span class="info-val">n8n_data ‚Üí /home/node/.n8n</span></li>
            <li><span class="info-key">depends_on</span><span class="info-val">scraper (healthy)</span></li>
            <li><span class="info-key">workflow</span><span class="info-val">UK News Digest (active)</span></li>
            <li><span class="info-key">schedule</span><span class="info-val">07:00 &amp; 18:00 daily</span></li>
            <li><span class="info-key">calls</span><span class="info-val">http://scraper:8765/run</span></li>
          </ul>
          <p class="depends-note">‚¨Ü Waits for scraper healthcheck before starting</p>
        </div>

        <!-- ARROW -->
        <div class="network-arrow">
          <div style="text-align:center;margin-bottom:4px;font-size:0.65rem;color:#4a5a75;">HTTP GET</div>
          <div style="display:flex;align-items:center;gap:4px;">
            <div style="flex:1;height:2px;background:linear-gradient(90deg,#1e6fd6,#1e8a3c);"></div>
            <div style="color:#1e8a3c;font-size:1rem;">‚ñ∂</div>
          </div>
          <div style="text-align:center;margin-top:4px;font-family:'Courier New',monospace;font-size:0.65rem;color:#3d8ef8;">/run</div>
          <div style="text-align:center;margin-top:2px;font-family:'Courier New',monospace;font-size:0.62rem;color:#2a4a6a;">JSON response</div>
          <div style="display:flex;align-items:center;gap:4px;margin-top:4px;">
            <div style="color:#1e6fd6;font-size:1rem;">‚óÄ</div>
            <div style="flex:1;height:2px;background:linear-gradient(90deg,#1e8a3c,#1e6fd6);"></div>
          </div>
        </div>

        <!-- SCRAPER CONTAINER -->
        <div class="container scraper">
          <div class="container-header">
            <div class="container-icon">üêç</div>
            <div>
              <div class="container-name">scraper</div>
              <div class="container-image">uk-news-scraper (Dockerfile.scraper)</div>
            </div>
          </div>

          <div class="port-row">
            <span class="port host-port">host:8765</span>
            <span class="port-arrow">‚Üî</span>
            <span class="port container-port">container:8765</span>
          </div>

          <ul class="info-list">
            <li><span class="info-key">base image</span><span class="info-val">python:3.12-slim</span></li>
            <li><span class="info-key">restart</span><span class="info-val">unless-stopped</span></li>
            <li><span class="info-key">entrypoint</span><span class="info-val">scraper_server.py</span></li>
            <li><span class="info-key">GET /health</span><span class="info-val">‚Üí {"status":"ok"}</span></li>
            <li><span class="info-key">GET /run</span><span class="info-val">‚Üí JSON {subject, htmlBody}</span></li>
            <li><span class="info-key">volume</span><span class="info-val">./output ‚Üí /app/output</span></li>
            <li><span class="info-key">scrapes</span><span class="info-val">BBC ¬∑ Guardian ¬∑ Independent ¬∑ Sky</span></li>
          </ul>
          <div class="health-badge">‚úÖ HEALTHY</div>
        </div>

      </div>

      <!-- VOLUMES -->
      <div class="volumes-section">
        <div class="volume">
          <div class="volume-title">üì¶ Named Volume ‚Äî n8n_data (external)</div>
          <div class="volume-path">
            <span>n8n_data</span> ‚Üí /home/node/.n8n<br>
            Stores: workflows, credentials,<br>
            execution history, settings
          </div>
        </div>
        <div class="volume">
          <div class="volume-title">üìÅ Bind Mount ‚Äî output/</div>
          <div class="volume-path">
            <span>/home/sufideen/Documents/<br>uk-news-scraper/output</span><br>
            ‚Üí /app/output<br>
            Stores: HTML digest files
          </div>
        </div>
        <div class="volume">
          <div class="volume-title">üîë Env Variables ‚Äî N8N</div>
          <div class="volume-path">
            <span>GENERIC_TIMEZONE</span>=Europe/London<br>
            <span>TZ</span>=Europe/London<br>
            <span>N8N_RUNNERS_ENABLED</span>=true<br>
            <span>N8N_ENFORCE_SETTINGS</span>=true
          </div>
        </div>
      </div>

    </div>
    <!-- END DOCKER NETWORK -->

    <!-- OTHER SERVICES ON HOST -->
    <div style="font-size:0.72rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#2a3a4a;margin-bottom:10px;">
      Other services running on host
    </div>
    <div class="host-services">
      <div class="host-service">
        <div class="svc-name">Portainer</div>
        <div class="svc-port">:8000 ¬∑ :9443</div>
        <div class="svc-desc">Docker GUI management</div>
      </div>
      <div class="host-service">
        <div class="svc-name">Open WebUI</div>
        <div class="svc-port">:3000</div>
        <div class="svc-desc">LLM chat interface</div>
      </div>
      <div class="host-service">
        <div class="svc-name">Host Browser</div>
        <div class="svc-port">‚Üí localhost:5678</div>
        <div class="svc-desc">N8N UI access</div>
      </div>
      <div class="host-service">
        <div class="svc-name">Gmail (cloud)</div>
        <div class="svc-port">SMTP / OAuth2</div>
        <div class="svc-desc">Receives digest email</div>
      </div>
    </div>

  </div>
  <!-- END HOST -->

  <!-- DATA FLOW SECTION -->
  <div class="dataflow">
    <div class="dataflow-title">End-to-End Data Flow</div>
    <div class="flow-steps">
      <div class="step">
        <div class="step-num">‚ë† Trigger</div>
        <div class="step-text">Cron fires</div>
        <div class="step-detail">07:00 / 18:00 GMT</div>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step">
        <div class="step-num">‚ë° N8N</div>
        <div class="step-text">HTTP Request</div>
        <div class="step-detail">GET /run :8765</div>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step">
        <div class="step-num">‚ë¢ Scraper</div>
        <div class="step-text">Fetch articles</div>
        <div class="step-detail">BBC¬∑Guard¬∑Ind¬∑Sky</div>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step">
        <div class="step-num">‚ë£ Build</div>
        <div class="step-text">HTML digest</div>
        <div class="step-detail">top 10 per source</div>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step">
        <div class="step-num">‚ë§ Save</div>
        <div class="step-text">Write to disk</div>
        <div class="step-detail">output/digests/</div>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step">
        <div class="step-num">‚ë• JSON</div>
        <div class="step-text">Return to N8N</div>
        <div class="step-detail">{subject, htmlBody}</div>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step">
        <div class="step-num">‚ë¶ Gmail</div>
        <div class="step-text">Send email</div>
        <div class="step-detail">OAuth2 ¬∑ HTML body</div>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step">
        <div class="step-num">‚ëß Inbox</div>
        <div class="step-text">Digest received</div>
        <div class="step-detail">mawarajudeen10@</div>
      </div>
    </div>
  </div>

  <footer>Docker Architecture ¬∑ UK News Scraper ¬∑ Internal Reference Document</footer>

</body>
</html>
